<section class="greybeardqol skill-selection" style="--theme-color: {{themeColor}}">
  <!-- Top: OR options as cards -->
  {{#if orOptions.length}}
  <div class="or-option-row card-grid" style="--col-count: {{orOptions.length}};">
    {{#each orOptions}}
      <div class="card dialog-card interactive or-option" data-option="{{this.id}}">
        <h3>{{this.name}}</h3>
        <p class="counter">
          {{#if this.trained}}{{this.trained}} <span class="bonus">{{ localize 'MoshQoL.Skills.Trained' }}</span>{{/if}}
          {{#if this.expert}}{{this.expert}} <span class="bonus">{{ localize 'MoshQoL.Skills.Expert' }}</span>{{/if}}
          {{#if this.master}}{{this.master}} <span class="bonus">{{ localize 'MoshQoL.Skills.Master' }}</span>{{/if}}
        </p>
      </div>
    {{/each}}
  </div>
  {{/if}}

  <!-- Wrapper for Skills + Lines -->
  <div class="skill-area-wrapper">
    <!-- SVG for skill dependency lines -->
    <svg id="skill-arrows" class="skill-arrow-overlay"></svg>
    <!-- Bottom: Skill columns -->
    <div class="skill-columns">
      <!-- Trained Skills Column -->
      <div class="skill-column">
        <div class="remaining-points">{{ localize 'MoshQoL.Skills.Trained' }} [ <span class="point-count" data-rank="trained">{{basePoints.trained}}</span> ]</div>
        <div class="pill-list">
          {{#each sortedSkills}}
            {{#if (or (eq this.system.rank 'trained') (eq this.system.rank 'Trained') (eq this.system.rank 'Formé'))}}
              <div class="pill interactive skill-card{{#each ../granted}}{{#if (eq this ../this.id)}} default-skill selected locked{{/if}}{{/each}}"
                data-rank="trained"
                data-uuid="{{this.uuid}}"
                data-skill-id="{{this.id}}"
                title="{{this.system.description}}">
                <img src="{{this.img}}" alt="{{this.name}}" />
                <span>{{this.name}}</span>
              </div>
            {{/if}}
          {{/each}}
        </div>
      </div>
      
      <!-- Expert Skills Column -->
      <div class="skill-column">
        <div class="remaining-points">{{ localize 'MoshQoL.Skills.Expert' }} [ <span class="point-count" data-rank="expert">{{basePoints.expert}}</span> ]</div>
        <div class="pill-list">
          {{#each sortedSkills}}
            {{#if (or (eq this.system.rank 'expert') (eq this.system.rank 'Expert'))}}
              <div class="pill interactive skill-card{{#each ../granted}}{{#if (eq this ../this.id)}} default-skill selected locked{{/if}}{{/each}}"
                data-rank="expert"
                data-uuid="{{this.uuid}}"
                data-skill-id="{{this.id}}"
                title="{{this.system.description}}">
                <img src="{{this.img}}" alt="{{this.name}}" />
                <span>{{this.name}}</span>
              </div>
            {{/if}}
          {{/each}}
        </div>
      </div>
      
      <!-- Master Skills Column -->
      <div class="skill-column">
        <div class="remaining-points">{{ localize 'MoshQoL.Skills.Master' }} [ <span class="point-count" data-rank="master">{{basePoints.master}}</span> ]</div>
        <div class="pill-list">
          {{#each sortedSkills}}
            {{#if (or (eq this.system.rank 'master') (eq this.system.rank 'Master') (eq this.system.rank 'Maître'))}}
              <div class="pill interactive skill-card{{#each ../granted}}{{#if (eq this ../this.id)}} default-skill selected locked{{/if}}{{/each}}"
                data-rank="master"
                data-uuid="{{this.uuid}}"
                data-skill-id="{{this.id}}"
                title="{{this.system.description}}">
                <img src="{{this.img}}" alt="{{this.name}}" />
                <span>{{this.name}}</span>
              </div>
            {{/if}}
          {{/each}}
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom: Skill columns -->
  <div class="confirm-button-row">
    <button type="button" id="confirm-button" class="pill confirm-button locked">{{ localize 'MoshQoL.UI.Confirm' }}</button>
  </div>

</section>
